<!DOCTYPE html>
<html>
<head>

<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
.loader {
  border: 16px solid #f3f3f3;
  border-radius: 50%;
  border-top: 16px solid #3498db;
  width: 120px;
  height: 120px;
  -webkit-animation: spin 2s linear infinite; /* Safari */
  animation: spin 2s linear infinite;
}

/* Safari */
@-webkit-keyframes spin {
  0% { -webkit-transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
</style>



</head>
<body>

<h2>click the button below to find your membership</h2>

<div class="loader" id =loaded></div>
<div> 
<button onclick="myallfull()">Click me</button>
</div>
    <table class="output" id =tabled></table>
    <script>
    var limit = 0;
    var limitzd=0;
    document.getElementById('loaded').style.display='none';
    
    function myallfull() {
      findinIt();
     setTimeout(myFunction, 3000);
   
    }
  function findinIt(){ 
    
   document.getElementById('loaded').style.display='block';
  document.getElementById('tabled').style.display='none';
    
const base = 'https://docs.google.com/spreadsheets/d/1ZKaqJ1y2T8KeITy_M9isOw3J6WtILqUjNfJXDfrL8FE/gviz/tq?';
const output = document.querySelector('.output');
const query = encodeURIComponent('Select A');
const url = base + '&tq=' + query;
    fetch(url)
    .then(res => res.text())
    .then(rep =>{
        const data = JSON.parse(rep.substr(47).slice(0,-2));
        const row = document.createElement('tr');
        output.append(row);
        data.table.cols.forEach((heading)=>{
            const cell = document.createElement('td');
            cell.textContent = heading.label;
            row.append(cell);
        })
        data.table.rows.forEach((main)=>{
            const container = document.createElement('tr');
            output.append(container);
            main.c.forEach((ele)=>{
                const cell = document.createElement('td');
                cell.textContent = ele.v;
                
                let text = cell.textContent;
                let result = text.includes("mukamwiza16");
                limitzd=9;
                 if(result==true) {
                 alert("tresult is  "+result)
                 limit=1;
                 limitzd=9;
                 }
              
                container.append(cell);
                
            
            })
        })
        
        if (limit==0) {
               alert(" no element found");
               limitzd=9;
                 }
                 
                 document.getElementById('loaded').style.display='none';
    })
    
    
     
     
      
    }
    
    
function myFunction() {

if (limitzd==0) {
  alert(' this is taking longer time than usual please make sure you have a good internet connection');
  document.getElementById('loaded').style.display='none';
  }
}
    </script>
</body>
</html>
